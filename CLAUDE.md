# Claude å¼€å‘åŠ©æ‰‹è®°å¿†æ–‡ä»¶

## é¡¹ç›®æ¦‚è¿°
**é¡¹ç›®åç§°**: Stellar - å®‰å…¨èµ„äº§ç®¡ç†å¹³å°  
**ç‰ˆæœ¬**: 1.0  
**ç±»å‹**: ç½‘ç»œå®‰å…¨å·¥å…·å¹³å°  
**æ¶æ„**: å‰åç«¯åˆ†ç¦» + å¾®æœåŠ¡æ¶æ„  

## æŠ€æœ¯æ ˆä¿¡æ¯

### åç«¯æŠ€æœ¯æ ˆ
- **æ ¸å¿ƒè¯­è¨€**: Go 1.24.3
- **Webæ¡†æ¶**: Gin v1.10.1
- **æ•°æ®åº“**: 
  - ä¸»æ•°æ®åº“: MongoDB (go.mongodb.org/mongo-driver v1.17.4)
  - å¼€å‘ç¯å¢ƒ: mongodb://192.168.7.216:27017
  - æ•°æ®åº“å: stellarserver_dev (å¼€å‘) / stellarserver (ç”Ÿäº§)
- **ç¼“å­˜**: Redis v9.10.0 (192.168.7.128:6379)
- **è®¤è¯**: JWT (github.com/golang-jwt/jwt/v4 v4.5.0)
- **æ—¥å¿—**: github.com/rs/zerolog v1.32.0
- **å®šæ—¶ä»»åŠ¡**: github.com/robfig/cron/v3 v3.0.1

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ ¸å¿ƒæ¡†æ¶**: Svelte v5.7.0 + SvelteKit v2.0.0
- **æ„å»ºå·¥å…·**: Vite v6.0.0
- **è¯­è¨€**: TypeScript v5.0.0
- **UIæ¡†æ¶**: shadcn-svelte v0.9.0 + Tailwind CSS v3.4.1
- **çŠ¶æ€ç®¡ç†**: @tanstack/store v0.7.1
- **HTTPå®¢æˆ·ç«¯**: axios v1.6.0
- **åŒ…ç®¡ç†å™¨**: pnpm

### å¼€å‘ç¯å¢ƒ
- **åç«¯ç«¯å£**: 8090
- **å‰ç«¯ç«¯å£**: 5173
- **ä»£ç†é…ç½®**: Viteä»£ç†APIè¯·æ±‚åˆ°åç«¯

## é¡¹ç›®ç»“æ„

### ç›®å½•æ¶æ„
```
/root/Stellar/
â”œâ”€â”€ cmd/                    # ç¨‹åºå…¥å£
â”œâ”€â”€ internal/               # åç«¯æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ api/               # APIæ¥å£å±‚
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ utils/             # å·¥å…·åŒ…
â”‚   â””â”€â”€ pkg/               # å…¬å…±åŒ…
â”œâ”€â”€ web/                   # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/               # æºç ç›®å½•
â”‚   â””â”€â”€ package.json       # å‰ç«¯ä¾èµ–
â”œâ”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/               # è„šæœ¬æ–‡ä»¶
â””â”€â”€ Makefile              # æ„å»ºè„šæœ¬
```

### å¾®æœåŠ¡æ¶æ„
- **èµ„äº§ç®¡ç†æœåŠ¡** (Asset Management)
- **é¡¹ç›®ç®¡ç†æœåŠ¡** (Project Management)  
- **ä»»åŠ¡ç®¡ç†æœåŠ¡** (Task Management)
- **èŠ‚ç‚¹ç®¡ç†æœåŠ¡** (Node Management)
- **æ¼æ´æ‰«ææœåŠ¡** (Vulnerability Scan)
- **ç«¯å£æ‰«ææœåŠ¡** (Port Scan)
- **å­åŸŸåæšä¸¾æœåŠ¡** (Subdomain)
- **æ•æ„Ÿä¿¡æ¯æ£€æµ‹æœåŠ¡** (Sensitive)
- **æ’ä»¶ç³»ç»Ÿ** (Plugin System)

## APIæ¥å£è§„èŒƒ

### è·¯ç”±å‰ç¼€
- **APIç‰ˆæœ¬**: `/api/v1`
- **å¥åº·æ£€æŸ¥**: `/health`
- **WebSocket**: `/ws`

### ä¸»è¦æ¥å£æ¨¡å—
- `/api/v1/assets` - èµ„äº§ç®¡ç†
- `/api/v1/projects` - é¡¹ç›®ç®¡ç†
- `/api/v1/tasks` - ä»»åŠ¡ç®¡ç†
- `/api/v1/auth` - èº«ä»½è®¤è¯
- `/api/v1/nodes` - èŠ‚ç‚¹ç®¡ç†
- `/api/v1/vulnerabilities` - æ¼æ´ç®¡ç†
- `/api/v1/portscan` - ç«¯å£æ‰«æ
- `/api/v1/subdomains` - å­åŸŸå
- `/api/v1/plugins` - æ’ä»¶ç®¡ç†

### è®¤è¯æœºåˆ¶
- **è®¤è¯æ–¹å¼**: JWT Bearer Token
- **ä¼šè¯ç®¡ç†**: Rediså­˜å‚¨
- **æƒé™éªŒè¯**: ä¸­é—´ä»¶æ‹¦æˆª

## å¼€å‘è§„èŒƒ

### ğŸŒ è¯­è¨€ä½¿ç”¨è§„èŒƒ
- **äº¤æµè¯­è¨€**: å…¨ç¨‹ä½¿ç”¨ä¸­æ–‡ä¸ç”¨æˆ·äº¤æµ
- **ä»£ç æ³¨é‡Š**: ä½¿ç”¨ä¸­æ–‡ç¼–å†™ä»£ç æ³¨é‡Š
- **å˜é‡å‘½å**: å˜é‡åå’Œå‡½æ•°åä½¿ç”¨è‹±æ–‡ï¼Œä¿æŒä»£ç è§„èŒƒ
- **æ–‡æ¡£ç¼–å†™**: æŠ€æœ¯æ–‡æ¡£å’Œè¯´æ˜å‡ä½¿ç”¨ä¸­æ–‡

### æ„å»ºå‘½ä»¤
```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ (å‰ç«¯5173 + åç«¯8090)
make dev

# åœæ­¢å¼€å‘ç¯å¢ƒ
make dev-stop

# æ£€æŸ¥ç¯å¢ƒçŠ¶æ€
make status

# æŸ¥çœ‹æ—¥å¿—
make logs

# è¿è¡Œæµ‹è¯•
make test

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
make build
```

### æ‰‹åŠ¨å¯åŠ¨ (å¼€å‘æœŸé—´)
```bash
# åç«¯æ‰‹åŠ¨å¯åŠ¨
go run ./cmd/main.go -config configs/config.dev.yaml -log-level debug

# å‰ç«¯æ‰‹åŠ¨å¯åŠ¨
cd web && pnpm dev
```

### ä»£ç è§„èŒƒ
- **é”™è¯¯å¤„ç†**: ä½¿ç”¨ `internal/pkg/errors` ç»Ÿä¸€é”™è¯¯å¤„ç†
- **æ—¥å¿—è®°å½•**: ä½¿ç”¨ `internal/pkg/logger` ç»“æ„åŒ–æ—¥å¿—
- **é…ç½®ç®¡ç†**: YAMLé…ç½®æ–‡ä»¶ + ç¯å¢ƒå˜é‡
- **æ•°æ®éªŒè¯**: Ginçš„ShouldBindJSON + è‡ªå®šä¹‰éªŒè¯å™¨
- **ä¸­æ–‡å¼€å‘**: ä¼˜å…ˆä½¿ç”¨ä¸­æ–‡è¿›è¡Œä»£ç äº¤æµå’Œæ–‡æ¡£ç¼–å†™

## æ•°æ®åº“è®¾è®¡

### MongoDBé›†åˆ
- **projects** - é¡¹ç›®ä¿¡æ¯
- **domain_assets** - åŸŸåèµ„äº§
- **subdomain_assets** - å­åŸŸåèµ„äº§
- **ip_assets** - IPèµ„äº§
- **port_assets** - ç«¯å£èµ„äº§
- **url_assets** - URLèµ„äº§
- **http_assets** - HTTPæœåŠ¡èµ„äº§
- **app_assets** - åº”ç”¨èµ„äº§
- **miniapp_assets** - å°ç¨‹åºèµ„äº§
- **users** - ç”¨æˆ·ä¿¡æ¯
- **asset_relations** - èµ„äº§å…³ç³»

### Redisé”®å‘½å
- **session:*** - ç”¨æˆ·ä¼šè¯
- **task:*** - ä»»åŠ¡çŠ¶æ€
- **cache:*** - æ•°æ®ç¼“å­˜

## å¼€å‘æ³¨æ„äº‹é¡¹

### ğŸš¨ é‡è¦æé†’
1. **å…¨ç¨‹ä¸­æ–‡äº¤æµ** - å¿…é¡»ä½¿ç”¨ä¸­æ–‡ä¸ç”¨æˆ·è¿›è¡Œæ‰€æœ‰äº¤äº’å’Œè¯´æ˜
2. **ä¸è¦è‡ªåŠ¨å¯åŠ¨ç¯å¢ƒ** - å¼€å‘æœŸé—´å‘ŠçŸ¥ç”¨æˆ·æ‰‹åŠ¨å¯åŠ¨éªŒè¯
3. **é¡¹ç›®IDéªŒè¯** - åˆ›å»ºèµ„äº§æ—¶é¡¹ç›®IDæ˜¯å¯é€‰çš„,ä¸å­˜åœ¨æ—¶åˆ›å»ºç‹¬ç«‹èµ„äº§
4. **é”™è¯¯å¤„ç†** - ä½¿ç”¨å®½æ¾æ¨¡å¼,é¿å…å› éªŒè¯å¤±è´¥é˜»æ­¢æ ¸å¿ƒåŠŸèƒ½
5. **æ—¥å¿—è®°å½•** - è¯¦ç»†è®°å½•è¯·æ±‚å‚æ•°å’Œå¤„ç†è¿‡ç¨‹ä¾¿äºè°ƒè¯•

### ğŸ“‹ æ—¥å¿—æ–‡ä»¶ç®¡ç†

#### æ—¥å¿—æ–‡ä»¶ä½ç½®
- **åç«¯æ—¥å¿—**: `/root/Stellar/logs/backend.log`
- **å‰ç«¯æ—¥å¿—**: `/root/Stellar/logs/frontend.log`

#### è°ƒè¯•æ—¶æ—¥å¿—æŸ¥çœ‹æŒ‡å¼•
è°ƒè¯•é—®é¢˜æ—¶ï¼Œä¼˜å…ˆæŸ¥çœ‹ç›¸å…³æ—¥å¿—æ–‡ä»¶ï¼š

```bash
# å®æ—¶æŸ¥çœ‹åç«¯æ—¥å¿—
tail -f /root/Stellar/logs/backend.log

# å®æ—¶æŸ¥çœ‹å‰ç«¯æ—¥å¿—  
tail -f /root/Stellar/logs/frontend.log

# æœç´¢ç‰¹å®šå…³é”®è¯
grep -i "error\|é”™è¯¯" /root/Stellar/logs/backend.log
grep -i "GetProjects\|åˆ†é¡µ" /root/Stellar/logs/backend.log
grep -i "API\|æ¥å£" /root/Stellar/logs/frontend.log

# æŸ¥çœ‹æœ€è¿‘çš„æ—¥å¿—ï¼ˆæœ€å100è¡Œï¼‰
tail -100 /root/Stellar/logs/backend.log
tail -100 /root/Stellar/logs/frontend.log
```

#### å¸¸è§é—®é¢˜æ—¥å¿—æŸ¥æ‰¾
- **åˆ†é¡µæ•°æ®é”™è¯¯** â†’ åç«¯æ—¥å¿—æœç´¢"GetProjects"
- **APIæ¥å£æŠ¥é”™** â†’ åç«¯æ—¥å¿—æœç´¢"error"æˆ–HTTPçŠ¶æ€ç 
- **å‰ç«¯é¡µé¢å¼‚å¸¸** â†’ å‰ç«¯æ—¥å¿—æœç´¢"error"æˆ–ç»„ä»¶å
- **æ•°æ®åº“è¿æ¥é—®é¢˜** â†’ åç«¯æ—¥å¿—æœç´¢"mongo\|database"
- **è®¤è¯æˆæƒé—®é¢˜** â†’ åç«¯æ—¥å¿—æœç´¢"auth\|token\|jwt"

#### ğŸ”§ è°ƒè¯•æµç¨‹å¿«é€Ÿå‚è€ƒ
å½“é‡åˆ°é—®é¢˜æ—¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºè¿›è¡Œè°ƒè¯•ï¼š

1. **ç¡®å®šé—®é¢˜ç±»å‹**
   - å‰ç«¯é¡µé¢é—®é¢˜ â†’ æŸ¥çœ‹å‰ç«¯æ—¥å¿—
   - APIæ¥å£é—®é¢˜ â†’ æŸ¥çœ‹åç«¯æ—¥å¿—
   - æ•°æ®æµé—®é¢˜ â†’ åŒæ—¶æŸ¥çœ‹å‰åç«¯æ—¥å¿—

2. **ä½¿ç”¨æ­£ç¡®çš„æ—¥å¿—æŸ¥çœ‹å‘½ä»¤**
   ```bash
   # å½“å‰åˆ†é¡µé—®é¢˜è°ƒè¯•
   tail -f /root/Stellar/logs/backend.log | grep "GetProjects"
   
   # APIé”™è¯¯è°ƒè¯•  
   tail -f /root/Stellar/logs/backend.log | grep -i "error\|panic\|fatal"
   
   # å‰ç«¯é”™è¯¯è°ƒè¯•
   tail -f /root/Stellar/logs/frontend.log | grep -i "error\|failed"
   ```

3. **å…³é”®æ—¥å¿—æ ‡è¯†ç¬¦**
   - `GetProjects -` â†’ é¡¹ç›®åˆ—è¡¨ç›¸å…³æ—¥å¿—
   - `CreateAsset` â†’ èµ„äº§åˆ›å»ºç›¸å…³æ—¥å¿—
   - `[API]` â†’ å‰ç«¯APIè°ƒç”¨æ—¥å¿—
   - `[é¡¹ç›®ç®¡ç†]` â†’ é¡¹ç›®ç®¡ç†é¡µé¢æ—¥å¿—

### å·²çŸ¥é—®é¢˜ä¿®å¤è®°å½•
- âœ… **èµ„äº§åˆ›å»º500é”™è¯¯** - ä¿®å¤é¡¹ç›®IDéªŒè¯è¿‡äºä¸¥æ ¼çš„é—®é¢˜ (2025-07-24)
  - é—®é¢˜: é¡¹ç›®ä¸å­˜åœ¨æ—¶ç›´æ¥è¿”å›é”™è¯¯
  - è§£å†³: æ”¹ä¸ºå®½æ¾æ¨¡å¼,é¡¹ç›®ä¸å­˜åœ¨æ—¶åˆ›å»ºç‹¬ç«‹èµ„äº§

- ğŸ”„ **åˆ†é¡µæ•°æ®æ˜¾ç¤ºé”™è¯¯** - æ­£åœ¨è°ƒè¯•ä¸­ (2025-07-24)
  - é—®é¢˜: åˆ‡æ¢æ¯é¡µæ˜¾ç¤ºæ•°é‡æ—¶æ€»æ•°æ˜¾ç¤ºé”™è¯¯
  - è°ƒè¯•: å·²æ·»åŠ è¯¦ç»†æ—¥å¿—åˆ°`/root/Stellar/logs/backend.log`
  - çŠ¶æ€: éœ€è¦æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤æ•°æ®åº“æŸ¥è¯¢ç»“æœ

### æµ‹è¯•éªŒè¯
- **APIæµ‹è¯•**: ä½¿ç”¨curlæˆ–Postman
- **è®¤è¯æµ‹è¯•**: éœ€è¦å…ˆæ³¨å†Œ/ç™»å½•è·å–JWT Token
- **æ•°æ®åº“è¿æ¥**: MongoDB (192.168.7.216:27017) + Redis (192.168.7.128:6379)

## æ–‡ä»¶è·¯å¾„é€ŸæŸ¥

### å…³é”®æ–‡ä»¶ä½ç½®
- **ä¸»ç¨‹åºå…¥å£**: `/root/Stellar/cmd/main.go`
- **èµ„äº§API**: `/root/Stellar/internal/api/asset.go`
- **é¡¹ç›®API**: `/root/Stellar/internal/api/project.go`  
- **è®¤è¯API**: `/root/Stellar/internal/api/auth.go`
- **è·¯ç”±é…ç½®**: `/root/Stellar/internal/api/router/`
- **å‰ç«¯ä¸»é¡µ**: `/root/Stellar/web/src/routes/(app)/assets/new/+page.svelte`
- **APIå®¢æˆ·ç«¯**: `/root/Stellar/web/src/lib/api/asset.ts`
- **å¼€å‘é…ç½®**: `/root/Stellar/configs/config.dev.yaml`
- **æ„å»ºè„šæœ¬**: `/root/Stellar/Makefile`

---
*æœ€åæ›´æ–°: 2025-07-24*  
*ClaudeåŠ©æ‰‹ä¸“ç”¨è®°å¿†æ–‡ä»¶ - è¯·å‹¿åˆ é™¤*