<!DOCTYPE html>
<html>
<head>
    <title>APIå¤„ç†å™¨æµ‹è¯•</title>
</head>
<body>
    <h1>APIå“åº”å¤„ç†å™¨æµ‹è¯•</h1>
    <div id="output"></div>
    
    <script>
        // æ¨¡æ‹Ÿåç«¯è¿”å›çš„æ•°æ®æ ¼å¼
        const mockApiResponse = {
            code: 200,
            message: "success",
            data: {
                data: [{id: 1, name: "é¡¹ç›®1"}, {id: 2, name: "é¡¹ç›®2"}],
                total: 12,
                page: 1,
                limit: 10
            }
        };
        
        // æ¨¡æ‹ŸAPIå“åº”å¤„ç†å™¨çš„é€»è¾‘
        function handlePaginatedResponse(response) {
            // æå–æ•°æ®
            let data = response;
            if (response.data !== undefined) {
                data = response.data;
            }
            
            // å¦‚æœå·²ç»æ˜¯åˆ†é¡µæ ¼å¼
            if (data && typeof data === 'object' && 'data' in data && Array.isArray(data.data)) {
                const total = data.total || data.totalCount || data.count || 0;
                const limit = data.limit || data.pageSize || data.size || 20;
                const result = {
                    data: data.data,
                    total: total,
                    page: data.page || data.pageIndex || data.currentPage || 1,
                    limit: limit,
                    totalPages: data.totalPages || Math.ceil(total / limit)
                };
                console.log('ğŸ”§ [APIå¤„ç†å™¨] æ ‡å‡†åˆ†é¡µæ ¼å¼å¤„ç†:', {
                    åŸå§‹æ•°æ®: data,
                    è§£æç»“æœ: result,
                    è®¡ç®—è¿‡ç¨‹: {
                        åŸå§‹total: data.total,
                        åŸå§‹limit: data.limit,
                        è®¡ç®—çš„total: total,
                        è®¡ç®—çš„limit: limit,
                        è®¡ç®—çš„totalPages: Math.ceil(total / limit)
                    }
                });
                return result;
            }
            
            return { data: [], total: 0, page: 1, limit: 20, totalPages: 0 };
        }
        
        // æµ‹è¯•å¤„ç†å™¨
        const result = handlePaginatedResponse(mockApiResponse);
        
        document.getElementById('output').innerHTML = `
            <h2>æµ‹è¯•ç»“æœ</h2>
            <p><strong>åŸå§‹å“åº”:</strong></p>
            <pre>${JSON.stringify(mockApiResponse, null, 2)}</pre>
            <p><strong>å¤„ç†åç»“æœ:</strong></p>
            <pre>${JSON.stringify(result, null, 2)}</pre>
            <p><strong>å…³é”®æ•°æ®:</strong></p>
            <ul>
                <li>æ•°æ®æ•°é‡: ${result.data.length}</li>
                <li>æ€»æ•°: ${result.total}</li>
                <li>æ¯é¡µ: ${result.limit}</li>
                <li>æ€»é¡µæ•°: ${result.totalPages}</li>
            </ul>
        `;
        
        console.log('æµ‹è¯•å®Œæˆï¼Œæ£€æŸ¥æ§åˆ¶å°æ—¥å¿—');
    </script>
</body>
</html>