# 版本 0.3 开发计划：项目/任务/节点管理

## 版本目标
- 完成项目管理、任务管理、节点管理等相关功能，前后端接口对齐，支持分布式任务调度与节点监控，前端具备完整的管理与交互能力。

---

## 任务Checklist

### TASK001 项目管理后端完善与优化
- 版本：0.3
- 状态：✅ 基本完成（高级功能待补充）
- 子任务：
  - ✅ 完善项目相关数据模型（Project/ProjectTargetData等），确保字段与业务需求一致
  - ✅ 优化项目CRUD接口，支持分页、标签分组、资产统计等
  - ❌ 增加/完善项目成员、活动日志、归档/导出等高级接口
  - ❓ 单元测试与接口文档补全
- AI提示词-原：
  > 请对internal/models/project.go与internal/api/project.go进行补全和优化，确保所有核心业务字段、接口、校验、错误处理、统计等功能完善，接口风格RESTful，类型安全。
- AI提示词-补充：
  > 需对照ScopeSentry-main项目管理API，补全成员管理、活动日志、归档、导出等功能，接口需与前端API服务对齐，便于迁移。
- 验收标准：
  - 项目管理后端接口功能完整，字段齐全，支持所有业务场景
  - 单元测试覆盖主要分支，接口文档完善
- 注意事项：
  - 保持与前端API服务参数、返回结构一致
  - 错误处理与权限校验需严格

---

### TASK002 项目管理前端API服务与类型定义
- 版本：0.3
- 状态：✅ 基本完成
- 子任务：
  - ✅ 补全web/src/lib/types/project.ts类型定义，覆盖所有后端字段
  - ✅ 优化web/src/lib/api/projects.ts，补全所有接口方法（成员、日志、归档、导出等）
  - ❌ 单元测试与类型校验
- AI提示词-原：
  > 请对web/src/lib/types/project.ts与api/projects.ts进行补全，确保所有后端接口均有类型定义与API方法，参数、返回值类型安全。
- AI提示词-补充：
  > 需对照ScopeSentry-UI-main前端API服务，迁移所有高级功能接口，保持与后端一致。
- 验收标准：
  - 类型定义与API方法覆盖所有后端接口
  - 类型校验无误，单元测试通过
- 注意事项：
  - 禁止直接fetch或新建axios实例，统一复用api
  - 类型定义需与后端同步

---

### TASK003 项目管理前端页面与组件
- 版本：0.3
- 状态：✅ 基础完成（高级功能待实现）
- 子任务：
  - ✅ 实现/迁移项目列表、详情、成员、日志、归档等页面
  - ✅ 封装可复用的项目卡片、成员管理、活动日志等组件
  - ✅ 状态管理与交互逻辑完善
  - ❌ 端到端测试
- AI提示词-原：
  > 请实现web/src/routes/(app)/projects/相关页面，封装项目管理相关组件，支持所有核心交互与展示。
- AI提示词-补充：
  > 参考ScopeSentry-UI-main项目管理页面与交互，迁移核心功能，优化UI/UX。
- 验收标准：
  - 页面功能完整，交互流畅，组件可复用
  - 端到端测试覆盖主要场景
- 注意事项：
  - 状态管理与API调用分离
  - UI需兼容移动端

---

### TASK004 任务管理后端完善与优化 - 🟢 执行引擎实现完成
- 版本：0.3
- 状态：✅ 基本完成 - 执行引擎实现，架构完整
- 子任务：
  - ✅ 完善任务相关数据模型（Task/TaskResult/TaskQueue/TaskEvent等）
  - ✅ 优化任务CRUD、调度、状态流转、依赖、重试、进度、结果等接口
  - ✅ 实现任务执行引擎（TaskExecutor接口、ExecutionEngine、具体执行器）
  - ✅ 实现子域名枚举执行器（SubdomainExecutor）
  - ✅ 实现端口扫描执行器（PortScanExecutor）
  - ✅ 实现资产发现执行器（AssetDiscoveryExecutor）
  - ✅ 集成执行引擎到TaskManager
  - ❌ 支持定时任务、模板、项目同步等高级功能
  - ❓ 单元测试与接口文档补全
- AI提示词-原：
  > 请对internal/models/task.go与internal/api/task.go进行补全和优化，确保所有核心业务字段、接口、调度、依赖、模板、同步等功能完善，接口风格RESTful，类型安全。
- AI提示词-补充：
  > 已实现任务执行引擎（ExecutionEngine）和具体执行器（SubdomainExecutor、PortScanExecutor、AssetDiscoveryExecutor），提供完整的任务执行能力。执行引擎支持并发控制、重试机制、进度跟踪、结果存储等核心功能。
- 验收标准：
  - 任务管理后端接口功能完整，支持所有业务场景
  - 任务执行引擎能够实际执行子域名枚举、端口扫描、资产发现等任务
  - 执行引擎具备完整的生命周期管理（启动、执行、取消、监控）
  - 支持任务重试、超时处理、错误处理等容错机制
  - 单元测试覆盖主要分支，接口文档完善
- 注意事项：
  - 任务调度与节点分发需健壮
  - 错误处理与权限校验需严格
  - 执行引擎支持动态注册新的任务执行器
  - 任务执行结果自动转换为资产数据

---

### TASK005 任务管理前端API服务与类型定义
- 版本：0.3
- 状态：✅ 已完成
- 子任务：
  - ✅ 新建web/src/lib/types/task.ts，定义所有任务相关类型
  - ✅ 新建web/src/lib/api/tasks.ts，封装所有任务管理API方法
  - ✅ 新建web/src/lib/stores/tasks.ts，实现Svelte状态管理
  - ❌ 单元测试与类型校验
- AI提示词-原：
  > 请新建web/src/lib/types/task.ts与api/tasks.ts，覆盖所有后端接口，类型安全，参数、返回值与后端一致。
- AI提示词-补充：
  > 参考ScopeSentry-UI-main前端API服务，迁移所有高级功能接口，保持与后端一致。
- 验收标准：
  - 类型定义与API方法覆盖所有后端接口
  - 类型校验无误，单元测试通过
- 注意事项：
  - 禁止直接fetch或新建axios实例，统一复用api
  - 类型定义需与后端同步

---

### TASK006 任务管理前端页面与组件
- 版本：0.3
- 状态：✅ 基本完成
- 子任务：
  - ✅ 实现任务列表页面（/tasks）- 支持搜索、过滤、批量操作
  - ✅ 实现任务详情页面（/tasks/[id]）- 支持实时更新、操作控制
  - ✅ 实现任务创建页面（/tasks/create）- 支持配置验证、模板选择
  - ✅ 实现核心任务组件（TaskCard、TaskFilters、TaskStatsCards等）
  - ✅ 实现通用UI组件（StatCard、ProgressBar等）
  - ✅ 实现日期时间工具函数
  - ❌ 实现任务模板管理页面
  - ❌ 实现任务调度页面
  - ❌ 端到端测试
- AI提示词-原：
  > 请实现web/src/routes/(app)/tasks/相关页面，封装任务管理相关组件，支持所有核心交互与展示。
- AI提示词-补充：
  > 参考ScopeSentry-UI-main任务管理页面与交互，迁移核心功能，优化UI/UX。
- 验收标准：
  - 页面功能完整，交互流畅，组件可复用
  - 端到端测试覆盖主要场景
- 注意事项：
  - 状态管理与API调用分离
  - UI需兼容移动端

---

### TASK007 节点管理后端完善与优化
- 版本：0.3
- 状态：✅ 基本完成
- 子任务：
  - ✅ 完善节点相关数据模型（Node/NodeConfig/NodeStatus等）
  - ✅ 实现节点数据仓库层（NodeRepository）- 支持完整的CRUD操作
  - ✅ 优化节点CRUD、状态监控、配置、心跳、任务统计等接口
  - ✅ 完善节点API处理器 - 支持注册、心跳、配置、统计、批量操作等
  - ✅ 集成节点管理器与仓库层
  - ✅ 实现节点健康检查和评分算法
  - ✅ 支持节点注册、角色、心跳监控等功能
  - ❌ 实现节点分布式调度算法
  - ❌ 单元测试与接口文档补全
- AI提示词-原：
  > 请对internal/models/node.go与internal/api/node.go进行补全和优化，确保所有核心业务字段、接口、监控、调度等功能完善，接口风格RESTful，类型安全。
- AI提示词-补充：
  > 需对照ScopeSentry-main节点管理API，补全注册、角色、分布式调度等功能，接口需与前端API服务对齐。
- 验收标准：
  - 节点管理后端接口功能完整，支持所有业务场景
  - 单元测试覆盖主要分支，接口文档完善
- 注意事项：
  - 节点心跳与状态监控需健壮
  - 错误处理与权限校验需严格

---

### TASK008 节点管理前端API服务与类型定义
- 版本：0.3
- 状态：✅ 已完成
- 子任务：
  - ✅ 新建web/src/lib/types/node.ts，定义所有节点相关类型
  - ✅ 新建web/src/lib/api/nodes.ts，封装所有节点管理API方法
  - ❌ 单元测试与类型校验
- AI提示词-原：
  > 请新建web/src/lib/types/node.ts与api/nodes.ts，覆盖所有后端接口，类型安全，参数、返回值与后端一致。
- AI提示词-补充：
  > 参考ScopeSentry-UI-main前端API服务，迁移所有高级功能接口，保持与后端一致。
- 验收标准：
  - 类型定义与API方法覆盖所有后端接口
  - 类型校验无误，单元测试通过
- 注意事项：
  - 禁止直接fetch或新建axios实例，统一复用api
  - 类型定义需与后端同步

---

### TASK009 节点管理前端页面与组件
- 版本：0.3
- 状态：✅ 已完成
- 子任务：
  - ✅ 实现节点列表页面（/nodes）- 支持搜索、过滤、批量操作
  - ✅ 实现节点详情页面（/nodes/[id]）- 支持状态监控、配置管理
  - ✅ 实现节点创建页面（/nodes/create）- 支持配置验证、表单提交
  - ✅ 封装可复用的节点管理组件
  - ✅ 状态管理与交互逻辑完善
  - ❌ 端到端测试
- AI提示词-原：
  > 请实现web/src/routes/(app)/nodes/相关页面，封装节点管理相关组件，支持所有核心交互与展示。
- AI提示词-补充：
  > 参考ScopeSentry-UI-main节点管理页面与交互，迁移核心功能，优化UI/UX。
- 验收标准：
  - 页面功能完整，交互流畅，组件可复用
  - 端到端测试覆盖主要场景
- 注意事项：
  - 状态管理与API调用分离
  - UI需兼容移动端

---

Checklist:
1. [✅ 项目管理后端完善与优化 - 基本完成，高级功能待补充]
2. [✅ 项目管理前端API服务与类型定义 - 基本完成]
3. [✅ 项目管理前端页面与组件 - 基础完成，高级功能待实现]
4. [✅ 任务管理后端完善与优化 - 基本完成，执行引擎实现完整]
5. [✅ 任务管理前端API服务与类型定义 - 已完成]
6. [✅ 任务管理前端页面与组件 - 基本完成，模板和调度功能待实现]
7. [✅ 节点管理后端完善与优化 - 基本完成，分布式调度算法待实现]
8. [✅ 节点管理前端API服务与类型定义 - 已完成]
9. [✅ 节点管理前端页面与组件 - 已完成]

【本计划已细化到最小可实现单元，所有任务均可独立追踪与验收。实施时请严格按Checklist顺序推进，每步完成后及时更新状态与文档。】 